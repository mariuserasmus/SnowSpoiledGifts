{% extends "base.html" %}

{% block content %}
<!-- Hero Section -->
<section id="home" class="hero-section">
    <div class="hero-overlay"></div>
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8 mx-auto text-center hero-content">
                <h1 class="hero-title">Welcome to<br>Snow Spoiled Gifts! üéÅ</h1>
                <p class="hero-subtitle">Unique cookie cutters, 3D printing services & personalized gifts ready to order. Create something special today!</p>
                <div class="hero-buttons mt-4">
                    <a href="#categories" class="btn btn-primary btn-lg me-2 mb-2">
                        <i class="fas fa-shopping-bag"></i> Shop Now
                    </a>
                    <a href="#notify" class="btn btn-outline-light btn-lg mb-2">
                        <i class="fas fa-bell"></i> Get Updates
                    </a>
                </div>
                <p class="launch-date mt-3"><i class="fas fa-sparkles"></i> New products added regularly!</p>
            </div>
        </div>
    </div>
</section>

<!-- Stats Counter Section -->
<section class="stats-section py-5" style="background: #2a2a2a;">
    <div class="container">
        <div class="row text-center g-4">
            <div class="col-6 col-md-3">
                <div class="stat-card">
                    <i class="fas fa-box-open fa-2x mb-3" style="color: var(--primary-color);"></i>
                    <h3 class="stat-number" data-target="{{ total_products }}" style="color: #ffffff;">0</h3>
                    <p class="stat-label mb-0" style="color: #cccccc;">Products Available</p>
                </div>
            </div>
            <div class="col-6 col-md-3">
                <div class="stat-card">
                    <i class="fas fa-tags fa-2x mb-3" style="color: var(--primary-color);"></i>
                    <h3 class="stat-number" data-target="6" style="color: #ffffff;">0</h3>
                    <p class="stat-label mb-0" style="color: #cccccc;">Categories</p>
                </div>
            </div>
            <div class="col-6 col-md-3">
                <div class="stat-card">
                    <i class="fas fa-users fa-2x mb-3" style="color: var(--primary-color);"></i>
                    <h3 class="stat-number" data-target="{{ total_customers }}" style="color: #ffffff;">0</h3>
                    <p class="stat-label mb-0" style="color: #cccccc;">Happy Customers</p>
                </div>
            </div>
            <div class="col-6 col-md-3">
                <div class="stat-card">
                    <i class="fas fa-fire fa-2x mb-3" style="color: var(--primary-color);"></i>
                    <h3 class="stat-number" data-target="{{ new_products }}" style="color: #ffffff;">0</h3>
                    <p class="stat-label mb-0" style="color: #cccccc;">New This Month</p>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
// Animated counter for stats
document.addEventListener('DOMContentLoaded', function() {
    const statsSection = document.querySelector('.stats-section');
    let hasAnimated = false;

    function animateCounter(element) {
        const target = parseInt(element.getAttribute('data-target'));
        const duration = 2000; // 2 seconds
        const increment = target / (duration / 16); // 60fps
        let current = 0;

        const timer = setInterval(() => {
            current += increment;
            if (current >= target) {
                element.textContent = target + '+';
                clearInterval(timer);
            } else {
                element.textContent = Math.floor(current) + '+';
            }
        }, 16);
    }

    function checkScroll() {
        if (hasAnimated) return;

        const rect = statsSection.getBoundingClientRect();
        const isVisible = rect.top < window.innerHeight && rect.bottom >= 0;

        if (isVisible) {
            hasAnimated = true;
            document.querySelectorAll('.stat-number').forEach(animateCounter);
        }
    }

    window.addEventListener('scroll', checkScroll);
    checkScroll(); // Check on load in case already visible
});
</script>

<!-- Categories Preview Section -->
<section id="categories" class="categories-section">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="section-title">Shop by Category</h2>
            <p class="section-subtitle">Cookie & Clay Cutters and Candles & Soaps are now live! More categories coming soon.</p>
        </div>
        <div class="row g-4">
            <!-- 3D Printing -->
            <div class="col-md-6 col-lg-4">
                <a href="{{ url_for('printing_3d') }}" class="category-card-link">
                    <div class="category-card">
                        <div class="category-image">
                            <img src="https://images.unsplash.com/photo-1703720675167-2fba006efb82?w=600&h=400&fit=crop&q=80" alt="3D Printing" onerror="this.src='https://placehold.co/600x400/6366f1/ffffff?text=3D+Printing&font=roboto'">
                            <div class="category-overlay">
                                <span class="category-badge live-now-badge">SHOP OPEN!</span>
                            </div>
                        </div>
                        <div class="category-content">
                            <h3>3D Printing</h3>
                            <p>Custom cookie cutters, cake toppers, toys, and personalized 3D creations</p>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Sublimation -->
            <div class="col-md-6 col-lg-4">
                <a href="#notify" class="category-card-link">
                    <div class="category-card">
                        <div class="category-image">
                            <img src="https://images.unsplash.com/photo-1542556398-95fb5b9f9b48?w=600&h=400&fit=crop&q=80" alt="Sublimation" onerror="this.src='https://placehold.co/600x400/ec4899/ffffff?text=Sublimation&font=roboto'">
                            <div class="category-overlay">
                                <span class="category-badge">Coming Soon</span>
                            </div>
                        </div>
                        <div class="category-content">
                            <h3>Sublimation</h3>
                            <p>Personalized mugs, t-shirts, and custom sublimation products</p>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Vinyl -->
            <div class="col-md-6 col-lg-4">
                <a href="#notify" class="category-card-link">
                    <div class="category-card">
                        <div class="category-image">
                            <img src="https://images.unsplash.com/photo-1572950947476-26a6e4111e80?w=600&h=400&fit=crop&q=80" alt="Vinyl" onerror="this.src='https://placehold.co/600x400/14b8a6/ffffff?text=Vinyl&font=roboto'">
                            <div class="category-overlay">
                                <span class="category-badge">Coming Soon</span>
                            </div>
                        </div>
                        <div class="category-content">
                            <h3>Vinyl</h3>
                            <p>Custom decals, stickers, and creative vinyl designs</p>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Giftboxes -->
            <div class="col-md-6 col-lg-4">
                <a href="#notify" class="category-card-link">
                    <div class="category-card">
                        <div class="category-image">
                            <img src="https://images.unsplash.com/photo-1549465220-1a8b9238cd48?w=600&h=400&fit=crop&q=80" alt="Giftboxes" onerror="this.src='https://placehold.co/600x400/f59e0b/ffffff?text=Giftboxes&font=roboto'">
                            <div class="category-overlay">
                                <span class="category-badge">Coming Soon</span>
                            </div>
                        </div>
                        <div class="category-content">
                            <h3>Giftboxes</h3>
                            <p>Curated gift boxes perfect for any occasion</p>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Candles and Soaps -->
            <div class="col-md-6 col-lg-4">
                <a href="{{ url_for('candles_soaps') }}" class="category-card-link">
                    <div class="category-card">
                        <div class="category-image">
                            <img src="https://images.unsplash.com/photo-1603006905003-be475563bc59?w=600&h=400&fit=crop&q=80" alt="Candles and Soaps" onerror="this.src='https://placehold.co/600x400/a78bfa/ffffff?text=Candles+%26+Soaps&font=roboto'">
                            <div class="category-overlay">
                                <span class="category-badge live-now-badge">SHOP OPEN!</span>
                            </div>
                        </div>
                        <div class="category-content">
                            <h3>Candles and Soaps</h3>
                            <p>Handcrafted candles and artisan soaps for a luxurious self-care experience</p>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Seasonal Events and Specials -->
            <div class="col-md-6 col-lg-4">
                <a href="#notify" class="category-card-link">
                    <div class="category-card">
                        <div class="category-image">
                            <img src="https://images.unsplash.com/photo-1513885535751-8b9238bd345a?w=600&h=400&fit=crop&q=80" alt="Seasonal Events and Specials" onerror="this.src='https://placehold.co/600x400/f43f5e/ffffff?text=Seasonal+Events&font=roboto'">
                            <div class="category-overlay">
                                <span class="category-badge notify-badge">Get Notified</span>
                            </div>
                        </div>
                        <div class="category-content">
                            <h3>Seasonal Events & Specials</h3>
                            <p>Regular specials, themed seasonal gift ideas, exclusive promotions, and exciting competitions</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Email Signup Section -->
<section id="notify" class="notify-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 mx-auto">
                <div class="notify-card">
                    <div class="text-center mb-4">
                        <i class="fas fa-envelope-open-text notification-icon"></i>
                        <h2 class="section-title">Stay in the Loop!</h2>
                        <p class="section-subtitle">Get exclusive updates on new products, special offers & more</p>
                    </div>
                    <form method="POST" action="{{ url_for('signup') }}" id="signupForm">
                        {{ form.hidden_tag() }}

                        <div class="mb-3">
                            {{ form.name(class="form-control form-control-lg", placeholder="Your Name") }}
                        </div>

                        <div class="mb-3">
                            {{ form.email(class="form-control form-control-lg", placeholder="Your Email", id="email") }}
                            <small class="form-text text-muted">Email addresses are case-insensitive</small>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">What are you interested in?</label>
                            <div class="interest-checkboxes">
                                {% for value, label in form.interests.choices %}
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" name="interests" value="{{ value }}" id="interest_{{ value }}">
                                    <label class="form-check-label" for="interest_{{ value }}">
                                        {{ label }}
                                    </label>
                                </div>
                                {% endfor %}
                            </div>
                        </div>

                        <div class="mb-3">
                            <small class="text-muted">
                                <i class="fas fa-lock"></i> We respect your privacy. No spam, ever.
                                By signing up, you agree to our <a href="{{ url_for('privacy_policy') }}" target="_blank">Privacy Policy</a>.
                            </small>
                        </div>

                        <button type="submit" class="btn btn-primary btn-lg w-100">
                            <i class="fas fa-envelope"></i> Notify Me!
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- About Section -->
<section id="about" class="about-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-4 mb-4 mb-lg-0">
                <img src="{{ url_for('static', filename='images/hero/hero-banner.jpg') }}" alt="About Us" class="img-fluid rounded shadow" onerror="this.src='https://placehold.co/600x400/2563eb/ffffff?text=About+Us&font=roboto'">
            </div>
            <div class="col-lg-4 mb-4 mb-lg-0">
                <h2 class="section-title">About Snow Spoiled Gifts</h2>
                <p class="lead">Welcome to Snow Spoiled Gifts, where creativity meets personalization!</p>
                <p>We're a passionate home-based business dedicated to creating unique, personalized gifts that make every occasion special. From custom 3D printed cookie cutters to beautiful sublimation products, creative vinyl designs, and curated gift boxes - we pour love into every creation.</p>
                <p>Our mission is simple: to help you spoil your loved ones (and yourself!) with gifts that are as unique as they are. Each product is crafted with care, attention to detail, and a whole lot of heart.</p>
                <p><strong>Start shopping today and discover something special!</strong></p>
            </div>
            <div class="col-lg-4 mb-4 mb-lg-0 d-flex justify-content-center align-items-center">
                <div class="about-logo-container">
                    <img src="{{ url_for('static', filename='images/logo/SSG.png') }}" alt="Snow Spoiled Gifts Logo" class="about-logo img-fluid">
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Contact Section -->
<section id="contact" class="contact-section">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="section-title">Get In Touch</h2>
            <p class="section-subtitle">Have questions? We'd love to hear from you!</p>
        </div>
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h4>Email</h4>
                    <p>
                        <a href="mailto:{{ config.CONTACT_EMAIL }}">{{ config.CONTACT_EMAIL }}</a><br>
                        <a href="mailto:info@snowspoiledgifts.co.za">info@snowspoiledgifts.co.za</a>
                    </p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fab fa-whatsapp"></i>
                    </div>
                    <h4>WhatsApp</h4>
                    <p><a href="{{ config.SOCIAL_MEDIA.whatsapp }}" target="_blank">{{ config.WHATSAPP_CONTACT_NUMBER }}</a></p>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="contact-card">
                    <div class="contact-icon">
                        <i class="fas fa-globe"></i>
                    </div>
                    <h4>Website & Social</h4>
                    <p>
                        <a href="{{ config.SITE_URL }}" target="_blank">{{ config.SITE_URL }}</a><br>
                        <a href="https://facebook.com/snowspoiledgifts" target="_blank">Facebook</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
/* Loading Overlay for Form Submissions */
#form-loading-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    z-index: 99999;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(4px);
}

#form-loading-overlay .loading-content {
    text-align: center;
    padding: 3rem;
    background: rgba(37, 99, 235, 0.1);
    border-radius: 16px;
    border: 2px solid rgba(37, 99, 235, 0.3);
    max-width: 500px;
    margin: 0 1rem;
}

#form-loading-overlay .spinner-border {
    border-width: 0.35rem;
}

#form-loading-overlay h4 {
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: white;
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    #form-loading-overlay .loading-content {
        padding: 2rem;
    }

    #form-loading-overlay h4 {
        font-size: 1.25rem;
    }

    #form-loading-overlay p {
        font-size: 0.9rem;
    }
}
</style>

<script>
// ============================================================================
// FORM LOADING INDICATOR SYSTEM
// ============================================================================

/**
 * Shows a loading overlay with spinner when forms are submitted
 * Prevents users from navigating away during submission
 */
function showFormLoadingIndicator(form, message) {
    // Create overlay if it doesn't exist
    let overlay = document.getElementById('form-loading-overlay');
    if (!overlay) {
        overlay = document.createElement('div');
        overlay.id = 'form-loading-overlay';
        overlay.innerHTML = `
            <div class="loading-content">
                <div class="spinner-border text-primary" role="status" style="width: 4rem; height: 4rem;">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <h4 class="mt-4" id="loading-message">Processing...</h4>
                <p class="text-white-50">Please wait while we process your request.</p>
                <p class="text-white-50 small"><i class="fas fa-info-circle"></i> Do not close or refresh this page</p>
            </div>
        `;
        document.body.appendChild(overlay);
    }

    // Update message if provided
    if (message) {
        const messageEl = overlay.querySelector('#loading-message');
        if (messageEl) {
            messageEl.textContent = message;
        }
    }

    // Show overlay
    overlay.style.display = 'flex';

    // Disable submit button and save original state
    const submitBtn = form.querySelector('button[type="submit"]');
    let originalBtnHTML = '';
    if (submitBtn) {
        originalBtnHTML = submitBtn.innerHTML;
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
    }

    // Change cursor to wait
    document.body.style.cursor = 'wait';

    // Only show navigation warning if submission takes longer than 2 seconds
    // This prevents annoying popups for fast submissions while protecting slow connections
    setTimeout(function() {
        window.onbeforeunload = function() {
            return "Your request is being submitted. Are you sure you want to leave?";
        };
    }, 2000);

    // Safety timeout: If form hasn't redirected within 30 seconds, assume connection error
    setTimeout(function() {
        // Check if overlay is still visible (form hasn't redirected)
        if (overlay && overlay.style.display === 'flex') {
            // Hide overlay
            overlay.style.display = 'none';

            // Re-enable submit button
            if (submitBtn) {
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalBtnHTML || '<i class="fas fa-bell"></i> Notify Me!';
            }

            // Reset cursor
            document.body.style.cursor = 'default';

            // Clear navigation warning
            window.onbeforeunload = null;

            // Show error message
            alert('Connection timeout: Unable to submit your request. Please check your internet connection and try again.');
        }
    }, 30000); // 30 second timeout
}

// Auto-lowercase email input on blur for better UX
document.addEventListener('DOMContentLoaded', function() {
    const emailInput = document.getElementById('email');
    if (emailInput) {
        emailInput.addEventListener('blur', function() {
            this.value = this.value.toLowerCase().trim();
        });
    }

    // Add loading indicator to signup form
    const signupForm = document.getElementById('signupForm');
    if (signupForm) {
        signupForm.addEventListener('submit', function(e) {
            showFormLoadingIndicator(signupForm, 'Signing You Up...');
        });
    }
});
</script>
{% endblock %}
